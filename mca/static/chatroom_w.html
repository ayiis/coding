<html lang="en">

<head>
    <meta charset="utf-8">
    <title>方块猫智能客服</title>
    <link rel="icon" href="/static/dist/images/mao.ico" type="image/x-icon" />
    <link rel="shortcut icon" href="/static/dist/images/mao.ico" type="image/x-icon"/>
    <style type="text/css">@import url(/static/css/chatroom.css);</style>
</head>

<body>
    <div id="app" _v-6f58f7a2="">
        <div class="sidebar" _v-6f58f7a2="">
            <div class="card" _v-7021c5b7="" _v-6f58f7a2="">
                <header _v-7021c5b7=""> <img class="avatar" width="40" height="40" _v-7021c5b7="" alt="coffce" src="dist/images/1.jpg">
                    <p class="name" _v-7021c5b7="">coffce</p>
                </header>
                <footer _v-7021c5b7=""> <input class="search" type="text" placeholder="search user..." _v-7021c5b7=""> </footer>
            </div>
            <div class="list" _v-7e56f776="" _v-6f58f7a2="">
                <ul _v-7e56f776="">
                    <li _v-7e56f776=""> <img class="avatar" width="30" height="30" _v-7e56f776="" alt="示例介绍" src="dist/images/mao.png">
                        <p class="name" _v-7e56f776="" id="goto_spzp">方块猫</p>
                    </li>
                    <li _v-7e56f776="" class="active"> <img class="avatar" width="30" height="30" _v-7e56f776="" alt="webpack" src="dist/images/3.jpg">
                         <p class="name" _v-7e56f776="" id="goto_w">w 酒店咨询</p>
                    </li>
                    <li _v-7e56f776=""> <img class="avatar" width="30" height="30" _v-7e56f776="" alt="webpack" src="dist/images/2.png">
                         <p class="name" _v-7e56f776="" id="goto_show">定样演示</p>
                    </li>
                </ul>
            </div>
        </div>
        <div class="main" _v-6f58f7a2="">
            <div class="message" _v-b412eea0="" _v-6f58f7a2="">
                <ul _v-b412eea0="" id="wul">
                    <li _v-b412eea0="">
                        <!-- <p class="time" _v-b412eea0=""> <span _v-b412eea0="">1:34</span> </p> -->
                        <div class="main" _v-b412eea0=""> <img class="avatar" width="30" height="30" _v-b412eea0="" src="dist/images/3.jpg">
                            <div class="text" _v-b412eea0="">Hello，我是方块猫自动客服助手，我最近在网络上浏览了许多关于W酒店的帖子，了解了很多网友对W酒店的看法。</div>
                        </div>
                    </li>
                    <li _v-b412eea0="">
                        <!-- <p class="time" _v-b412eea0=""> <span _v-b412eea0="">1:34</span> </p> -->
                        <div class="main" _v-b412eea0=""> <img class="avatar" width="30" height="30" _v-b412eea0="" src="dist/images/3.jpg">
                            <div class="text" _v-b412eea0="">如果您想知道网友们的评价，可以这样问我：W酒店怎么样？</div>
                        </div>
                    </li>
                    <!-- <li _v-b412eea0="">
                        <div class="main self" _v-b412eea0=""> <img class="avatar" width="30" height="30" _v-b412eea0="" src="dist/images/1.jpg">
                            <div class="text" _v-b412eea0="">房间舒服吗？</div>
                        </div>
                    </li>
                    <li _v-b412eea0="">
                        <div class="main" _v-b412eea0=""> <img class="avatar" width="30" height="30" _v-b412eea0="" src="dist/images/3.jpg">
                            <div class="text" _v-b412eea0="">63%的网友都说 好,不错,小</div>
                        </div>
                    </li> -->
                </ul>
            </div>
            <div class="text" _v-34cd3954="" _v-6f58f7a2="">
                <textarea placeholder="按 Enter 发送" id="msgbox"_v-34cd3954=""></textarea>
            </div>
            <button style="position: absolute;bottom: 10px;right: 10px;height: 27px;width: 56px;background-color: #eee;border: 1px solid #eee;border-radius: 4px;color: #666;" id="btn_send" onclick="send_message()">发送</button>
        </div>
    </div>
    <div style="display:none;" id="ai_temp">
        <li _v-b412eea0="">
            <!-- <p class="time" _v-b412eea0=""> <span _v-b412eea0="">1:34</span> </p> -->
            <div class="main" _v-b412eea0=""> <img class="avatar" width="30" height="30" _v-b412eea0="" src="dist/images/3.jpg">
                <div class="text" _v-b412eea0="">xxxxxx</div>
            </div>
        </li>
    </div>
    <div style="display:none;" id="user_temp">
        <li _v-b412eea0="">
            <!-- <p class="time" _v-b412eea0=""> <span _v-b412eea0="">1:34</span> </p> -->
            <div class="main self" _v-b412eea0=""> <img class="avatar" width="30" height="30" _v-b412eea0="" src="dist/images/1.jpg">
                <div class="text" _v-b412eea0="">yyyyyy</div>
            </div>
        </li>
    </div>
</body>
<script type="text/javascript" src="/static/dist/jquery-3.3.1.min.js"></script>
<script type="text/javascript">
    $('#msgbox').on('keydown', function(event){
        if (event.ctrlKey && event.keyCode == 13)  {
            send_message();
        }
        if (event.keyCode == 13)  {
            send_message();
        }
    });
    function send_message() {
        var self = this;
        var data = {
            'type': 'w',
            'text': $('#msgbox').val() || '',
        }
        if (!data.text){
            return false;
        }

        $('#msgbox').val(null);

        var $user_word = $($('#user_temp').html());
        $user_word.find('.text').text(data.text);
        $('#wul').append($user_word);
        $(".message").scrollTop($(".message")[0].scrollHeight);

        $.ajax({
            type: 'POST',
            url: '/staticapi/api/send_message',
            data: JSON.stringify(data),
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            success: function(json) {
                if (json.code !== 200) {
                    console.log(json.message);
                } else {
                    var $user_word = $($('#ai_temp').html());
                    $user_word.find('.text').text(json.data[0]);
                    $('#wul').append($user_word);
                    $(".message").scrollTop($(".message")[0].scrollHeight);
                }
            },
            error: function(error) {
                return console.log(error);
            },
        });
    }
    $('#goto_spzp').parent().on('click', function(event){
        window.location = "/static/chatroom.html";
    });
    $('#goto_w').parent().on('click', function(event){
        window.location = "/static/chatroom_w.html";
    });
    $('#goto_show').parent().on('click', function(event){
        window.location = "/static/chatroom_show.html";
    });
</script>
</html>